<div class="panel panel-default <%=population[:type]%>_children">
  <div class="panel-heading">
    <h4 class="panel-title panel-population">
      <a data-toggle="collapse" href="#collapse_<%=measure[:cms_id]%>_<%=measure[:sub_id]%>_<%=population[:hqmf_id]%>">
        <div>
          <% title = population[:title] %>
          <% if (population[:type] == 'OBSERV') then title = 'Observations' end %>
          <span class="population-label <%=title%> rationale eval-<%=@rationale[population[:type]]%>"><b><%=title%></b><span class="sr-only sr-highlight-status"></span></span>
          <div class="pull-right">
            <!-- {{#if exceedsComplexityThreshold}}
              <i class="fa fa-lg fa-angle-right toggle-icon" aria-hidden="true"></i>
            {{else}} -->
              <i class="fa fa-lg fa-angle-down toggle-icon" aria-hidden="true"></i>
            <!-- {{/if}} -->
            <span class="sr-only">toggle <%=title%></span>
          </div>
        </div>
      </a>
    </h4>
  </div>

<!-- {{#unless exceedsComplexityThreshold}} {{/unless}} -->
  <div id="collapse_<%=measure[:cms_id]%>_<%=measure[:sub_id]%>_<%=population[:hqmf_id]%>" class="panel-collapse collapse in">
    <div class="panel-body">
      <!-- {{#if deferRender}}
        <img src="/assets/loading.gif"></img>
      {{else}} -->
        <!-- {{#if comments}}{{#each comments}}<div class="logic-comment"># {{this}}</div>{{/each}}{{/if}} -->
        <% if population[:preconditions] %>
          <% rootPrecondition = population[:preconditions][0] %>
          <% if rootPrecondition[:preconditions] %>
            <% rootPrecondition[:preconditions].each do |precondition| %>
              <!-- TODO: check negation? -->
              <!-- {{view "PreconditionLogic" precondition=this parentPrecondition=../rootPreconditon parentNegation=../rootPreconditon.negation measure=../measure suppressDataCriteriaHighlight=../suppressDataCriteriaHighlight}} -->
              <%= render partial: 'precondition', locals: {precondition: precondition, parentPrecondition: rootPrecondition, parentNegation: rootPrecondition[:negation], measure: measure} %>
            <% end %>
          <% else %>
              <li>
              <!-- TODO: proper aggregator translation? -->
              <!-- {{#if aggregator}}{{translate_aggregator aggregator}}: {{/if}}  -->
                <% if population[:aggregator] %>
                  <%= population[:aggregator] %> of
                <% end %>
                <!-- {{view "DataCriteriaLogic" reference=rootPreconditon.reference measure=../measure tag="span" suppressDataCriteriaHighlight=../suppressDataCriteriaHighlight}} -->
                <%= render partial: 'data_criteria', locals: {reference: rootPrecondition[:reference], expandVariable: false, measure: measure, tag: "span"} %>
              </li>
            </ul>
          <% end %>
        <% else %>
          None
        <% end %>
      <!-- {{/if}} -->
    </div>
  </div>
</div>
